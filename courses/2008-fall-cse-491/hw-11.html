<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.4: http://docutils.sourceforge.net/" />
<title>Homework 11</title>
<style type="text/css">

/*
:Author: David Goodger
:Contact: goodger@users.sourceforge.net
:Date: $Date: 2005-12-18 01:56:14 +0100 (Sun, 18 Dec 2005) $
:Revision: $Revision: 4224 $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin-left: 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left {
  clear: left }

img.align-right {
  clear: right }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font-family: serif ;
  font-size: 100% }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em ;
  background-color: #eeeeee }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

tt.docutils {
  background-color: #eeeeee }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="homework-11">
<h1 class="title">Homework 11</h1>
<p>Due Thursday, November 13th, at the beginning of class.</p>
<p>Please put everything in homework11.zip in the root of your svn.
(This should not include the raw actor/actresses lists, please!)</p>
<div class="section">
<h1><a id="loading-searching-large-amounts-of-data" name="loading-searching-large-amounts-of-data">Loading &amp; searching large amounts of data</a></h1>
<p>(2.5 points)</p>
<p>The files 'actors.list.gz' and 'actresses.list.gz' at</p>
<blockquote>
<a class="reference" href="ftp://ftp.fu-berlin.de/pub/misc/movies/database/">ftp://ftp.fu-berlin.de/pub/misc/movies/database/</a></blockquote>
<p>(see the Comprehensive Knowledge Archive Network for more information,
at <a class="reference" href="http://ckan.net/package/read/imdb">http://ckan.net/package/read/imdb</a>) contain actor/movie and
actress/movie pairs.  Download these two lists and load them into
the database schema you developed for last week.</p>
<p>You can feel free to write your own parsing code, or you can use mine,
available in the usual place:</p>
<blockquote>
<a class="reference" href="http://class.ged.idyll.org/svn/files/hw-11/imdb/">http://class.ged.idyll.org/svn/files/hw-11/imdb/</a></blockquote>
<p>The IMDB database is quite large so I'd suggest developing your db
loading and search data in the context of a few thousand records
rather than the full database!  However, please be sure to load
in records up to 'C' in what you check in;</p>
<p>(And please check in a fully-working webserve.py and webserve-info.db;
yes, I know they're big.)</p>
<p>You don't need to add any functionality to your actor/actress searching
code, other than loading the data in and making sure it all works.</p>
</div>
<div class="section">
<h1><a id="sessions-and-session-ids" name="sessions-and-session-ids">Sessions and session IDs</a></h1>
<p>(2.5 points)</p>
<p>If you think about the user handling code I asked you to write for
earlier homeworks, you'll realize how stupid and pointless it is.
It's incredibly easy for you to log in as some other user by
just changing the cookie, which is client-based!  Let's fix that,
by using a randomly generated string, so that people would have to
be able to guess the cookie value in order to masquerade as another
user.</p>
<p>Create a new table in your database, 'sessions', that contains an
integer user_id and a text session_id.  When people log in, create a
new entry in this table with a new session_id, generated from the
following function:</p>
<pre class="literal-block">
import random, crypt

# per-site secret; only first two characters are used.
secret = 'ZZ'

# initialize random number generator from the system time on import.
random.seed()

def generate_session_id(user):
    &quot;&quot;&quot;
    Generate a unique session ID based on the user name with the given
    site-specific secret.  How secure is this, really?
    &quot;&quot;&quot;
    salt = secret[:2]
    return crypt.crypt(user + str(random.random()), salt)
</pre>
<p>Then set this session ID as the value for the client cookie named
'session'.</p>
<p>Change all your user-based code to retrieve the username by looking
the session ID up in the database; your code <em>should not pay attention
to any other client-side data</em>, i.e. don't use the 'user' cookie any
more!</p>
<p>(As before, /auth/print should print out the username based on the
session ID, and /auth/logout should clear the session ID.)</p>
<p>Note, the user-cookie specific unit tests have been deleted; see the new
test file,</p>
<blockquote>
<a class="reference" href="http://class.ged.idyll.org/svn/files/hw-11/webserve-test.py">http://class.ged.idyll.org/svn/files/hw-11/webserve-test.py</a></blockquote>
<p>Your twill and Selenium tests should all still work.</p>
</div>
</div>
</body>
</html>
